<div class="box box-default">
  <div class="box-header with-border">
    <h3 class="box-title">
      Product
    </h3>
  </div>
  <div class="box-body">
    <div class="table-responsive">
      <table id="review_table" class="table table-bordered table-striped">
        <thead>
          <tr>
            <th style="width: 10%;">id</th>
            <th style="width: 10%;">Name </th>
            <th style="width: 10%;">Price</th>
            <th style="width: 10%;">Quantity</th>
            <th style="width: 10%;">Sold</th>
            <th style="width: 10%;">Stock Available</th>
            <th style="width: 10%;">Posted on</th>
            <th style="width: 10%;">Average Rating</th>
          </tr>
        </thead>
        <tbody>
          <% @product.each do |product| %>
            <tr>
              <td> <%= product.id %></td>
              <td> <%= product.name %></td>
              <td> <%= product.price %></td>
              <td> <%= product.quantity %></td>
              <td> <%= product.purchases.sum(:quantity) %></td>
              <td> <%= product.quantity.to_i - product.purchases.sum(:quantity).to_i %></td>
              <td> <%= product.created_at.strftime("%d-%m-%Y %H:%M") %></td>
              <td> <%= product.created_at.strftime("%d-%m-%Y %H:%M") %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<%= link_to 'Buy', new_product_purchase_url(@product) %>

<br />
<br />

<div>

<h2>Purchases</h2>

<ul>
<% @product.first.purchases.each do |purchase| %>
  <li><%= link_to "Purchase ##{purchase.id}", product_purchase_url(@product, purchase) %></li>
<% end %>
</ul>

</div>
